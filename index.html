<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MovieDB</title>
    <link
      href="https://fonts.googleapis.com/css?family=Roboto:100"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="index.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="icon" href="./images/favicon.ico" type="image/x-icon" />
  </head>
  <body>
    <h1>MovieDB</h1>
    <form id="form">
      <input type="text" placeholder="Enter Movie Name Here" id="name" />
      <input type="submit" value="search" />
    </form>
    <div id="temp">
      <p style="color: white">
        Please type any movie name in search box to get more information about
        the movie
      </p>
      <img
        src="https://c.tenor.com/r3XdvPsAV3kAAAAM/despicable-me-minions.gif"
        width="100px"
        height="100px"
      />
    </div>
    <div id="container"></div>
    <div class="light x1"></div>
    <div class="light x2"></div>
    <div class="light x3"></div>
    <div class="light x4"></div>
    <div class="light x5"></div>
    <div class="light x6"></div>
    <div class="light x7"></div>
    <div class="light x8"></div>
    <div class="light x9"></div>
  </body>
</html>
<script>
  let temp = document.querySelector("#temp");
  let url;
  let container = document.querySelector("#container");
  document.querySelector("form").addEventListener("submit", function (e) {
    container.textContent = null;
    e.preventDefault();

    let name = form.name.value;

    url = `https://www.omdbapi.com/?s=${name}&apikey=a20d168d`;

    getDetails();
  });

  async function getDetails() {
    let res = await fetch(url);

    let movie = await res.json();

    if (movie.Response === "False") {
      error();
    } else {
      let arr = movie.Search;

      arr.forEach(async function (item) {
        let id = item.imdbID;

        let url2 = `https://www.omdbapi.com/?i=${id}&apikey=a20d168d`;

        let res2 = await fetch(url2);

        let movie2 = await res2.json();

        showMovie(movie2);
      });
    }
  }

  function showMovie(movie) {
    temp.style.display = "none";
    let div = document.createElement("div");
    div.setAttribute("id", "mainDiv");

    let left_div = document.createElement("div");
    left_div.setAttribute("id", "image_div");

    let img = document.createElement("img");
    img.src = movie.Poster;

    left_div.append(img);

    let right_div = document.createElement("div");
    right_div.setAttribute("id", "content_div");

    let title = document.createElement("p");
    title.innerHTML = `${movie.Title}(${movie.Language})`;
    title.setAttribute("id", "title");

    let runtime = document.createElement("p");
    runtime.innerHTML = `${movie.Runtime}&nbsp&nbsp${movie.Released}`;
    runtime.setAttribute("id", "runtime");

    let desc = document.createElement("p");
    desc.innerHTML = `${movie.Plot}`;
    desc.setAttribute("id", "description");

    let director = document.createElement("p");
    director.innerHTML = `Director : ${movie.Director}`;
    director.setAttribute("class", "common");

    let actors = document.createElement("p");
    actors.innerHTML = `Actors : ${movie.Actors}`;
    actors.setAttribute("class", "common");

    let genre = document.createElement("p");
    genre.innerHTML = `Genres : ${movie.Genre}`;
    genre.setAttribute("class", "common");

    let imdb = document.createElement("p");
    imdb.innerHTML = `IMDB Rating : ${movie.imdbRating}`;
    imdb.setAttribute("class", "common");

    if (movie.imdbRating > 8.5) {
      let img1 = document.createElement("img");
      img1.src = "re.png";
      img1.setAttribute("id", "re");

      left_div.append(img, img1);
    }

    let award = document.createElement("p");
    award.innerHTML = `Awards : ${movie.Awards}`;
    award.setAttribute("class", "common");

    let box_office = document.createElement("p");
    box_office.innerHTML = `Box Office : ${movie.BoxOffice}`;
    box_office.setAttribute("class", "common");

    right_div.append(
      title,
      runtime,
      desc,
      director,
      actors,
      genre,
      imdb,
      award,
      box_office
    );

    if (movie.imdbRating > 8.5) {
      let img1 = document.createElement("img");
      img1.src = "./images/re.png";
      img1.setAttribute("id", "re");

      left_div.append(img, img1);
    }
    div.append(left_div, right_div);

    container.append(div);
  }

  function error() {
    temp.style.display = "none";
    container.textContent = null;

    let img = document.createElement("img");
    img.src = "https://c.tenor.com/IHdlTRsmcS4AAAAM/404.gif";
    img.style.width = "400px";
    img.style.height = "300px";
    img.style.marginLeft = "400px";

    container.append(img);
  }
</script>
